# ============================================================================
# LEVYTHON HTTP CLIENT EXAMPLE
# ============================================================================
# This example demonstrates the HTTP module for making web requests.
# Run with: ./levython examples/http_client.levy
# ============================================================================

import http

say("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
say("â•‘           LEVYTHON HTTP CLIENT EXAMPLE                               â•‘")
say("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")

# -----------------------------------------------------------------------------
# HTTP GET Request
# -----------------------------------------------------------------------------
say("")
say("ğŸŒ [Demo 1] Simple HTTP GET Request")
say("   URL: http://httpbin.org/get")
say("   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

response <- http.get("http://httpbin.org/get")
say("   Status: " + str(response["status"]))
say("   OK: " + str(response["ok"]))
say("   Elapsed: " + str(response["elapsed_ms"]) + "ms")

# -----------------------------------------------------------------------------
# HTTP POST Request with JSON Body
# -----------------------------------------------------------------------------
say("")
say("ğŸ“¤ [Demo 2] HTTP POST Request with JSON")
say("   URL: http://httpbin.org/post")
say("   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

headers <- {"Content-Type": "application/json"}
body <- "{\"name\": \"Levython\", \"version\": \"1.0\", \"language\": \"awesome\"}"

response <- http.post("http://httpbin.org/post", body, headers)
say("   Status: " + str(response["status"]))
say("   OK: " + str(response["ok"]))
say("   Elapsed: " + str(response["elapsed_ms"]) + "ms")

# -----------------------------------------------------------------------------
# HTTPS Request (Secure)
# -----------------------------------------------------------------------------
say("")
say("ğŸ”’ [Demo 3] HTTPS Secure Request")
say("   URL: https://httpbin.org/get")
say("   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

response <- http.get("https://httpbin.org/get")
say("   Status: " + str(response["status"]))
say("   OK: " + str(response["ok"]))
say("   Secure connection successful!")

# -----------------------------------------------------------------------------
# Custom Headers
# -----------------------------------------------------------------------------
say("")
say("ğŸ“‹ [Demo 4] Request with Custom Headers")
say("   URL: http://httpbin.org/headers")
say("   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

custom_headers <- {
    "X-Custom-Header": "Levython-Demo",
    "User-Agent": "Levython/1.0",
    "Accept": "application/json"
}
response <- http.get("http://httpbin.org/headers", custom_headers)
say("   Status: " + str(response["status"]))
say("   OK: " + str(response["ok"]))

# -----------------------------------------------------------------------------
# HTTP Status Codes
# -----------------------------------------------------------------------------
say("")
say("ğŸ“Š [Demo 5] HTTP Status Codes")
say("   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

say("   Testing 200 OK...")
response <- http.get("http://httpbin.org/status/200")
say("   â†’ Status: " + str(response["status"]) + " | OK: " + str(response["ok"]))

say("")
say("   Testing 404 Not Found...")
response <- http.get("http://httpbin.org/status/404")
say("   â†’ Status: " + str(response["status"]) + " | OK: " + str(response["ok"]))

say("")
say("   Testing 500 Server Error...")
response <- http.get("http://httpbin.org/status/500")
say("   â†’ Status: " + str(response["status"]) + " | OK: " + str(response["ok"]))

# -----------------------------------------------------------------------------
# HTTP PUT Request
# -----------------------------------------------------------------------------
say("")
say("ğŸ“ [Demo 6] HTTP PUT Request")
say("   URL: http://httpbin.org/put")
say("   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

put_body <- "{\"update\": \"data\", \"id\": 42}"
response <- http.put("http://httpbin.org/put", put_body, {"Content-Type": "application/json"})
say("   Status: " + str(response["status"]))
say("   OK: " + str(response["ok"]))

# -----------------------------------------------------------------------------
# HTTP DELETE Request
# -----------------------------------------------------------------------------
say("")
say("ğŸ—‘ï¸  [Demo 7] HTTP DELETE Request")
say("   URL: http://httpbin.org/delete")
say("   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

response <- http.delete("http://httpbin.org/delete")
say("   Status: " + str(response["status"]))
say("   OK: " + str(response["ok"]))

# -----------------------------------------------------------------------------
# Summary
# -----------------------------------------------------------------------------
say("")
say("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
say("â•‘  âœ… HTTP CLIENT DEMO COMPLETE                                        â•‘")
say("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
say("â•‘  Available HTTP Methods:                                             â•‘")
say("â•‘    â€¢ http.get(url, headers?)       - GET request                     â•‘")
say("â•‘    â€¢ http.post(url, body, headers) - POST request                    â•‘")
say("â•‘    â€¢ http.put(url, body, headers)  - PUT request                     â•‘")
say("â•‘    â€¢ http.patch(url, body, headers)- PATCH request                   â•‘")
say("â•‘    â€¢ http.delete(url, headers?)    - DELETE request                  â•‘")
say("â•‘    â€¢ http.head(url, headers?)      - HEAD request                    â•‘")
say("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
